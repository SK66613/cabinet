<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8" />
  <title>–õ–∏—á–Ω—ã–π –∫–∞–±–∏–Ω–µ—Ç ¬∑ MiniApp Analytics</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <link rel="stylesheet" href="style.css" />
</head>
<body>
  <div class="layout">
    <!-- SIDEBAR -->
    <aside class="sidebar">
      <div class="sidebar__brand">
        <div class="brand-logo">
          <img src="logo.png" alt="Sales Genius" />
        </div>
        <div>
          <div class="brand-text-main">Sales Genius</div>
          <div class="brand-text-sub">MiniApp ¬∑ Analytics</div>
        </div>
      </div>

      <div class="sidebar__client">
        <div class="sidebar__client-title">–¢–µ–∫—É—â–∏–π –∫–ª–∏–µ–Ω—Ç</div>
        <div class="sidebar__client-name" id="sidebarShopName">–ú–∞–≥–∞–∑–∏–Ω ¬´–®–º–µ–ª—å –Ω–∞ –¢–≤–µ—Ä—Å–∫–æ–π¬ª</div>
        <div class="sidebar__client-note" id="sidebarShopNote">–°—Ç–∞—Ä—Ç –º–∏–Ω–∏-–∞–ø–ø–∞: 05.11.2025</div>
      </div>

      <nav class="sidebar__nav">
        <div class="nav-item nav-item--active" data-view="dashboard">
          <span class="nav-dot"></span>
          <span>–î–∞—à–±–æ—Ä–¥</span>
        </div>
        <div class="nav-item" data-view="sales">
          <span class="nav-dot"></span>
          <span>–ü—Ä–æ–¥–∞–∂–∏</span>
        </div>
        <div class="nav-item" data-view="clients">
          <span class="nav-dot"></span>
          <span>–ö–ª–∏–µ–Ω—Ç—ã</span>
        </div>
        <div class="nav-item" data-view="gamification">
          <span class="nav-dot"></span>
          <span>–ì–µ–π–º–∏—Ñ–∏–∫–∞—Ü–∏—è</span>
        </div>
        <div class="nav-item" data-view="promos">
          <span class="nav-dot"></span>
          <span>–ê–∫—Ü–∏–∏ –∏ –ø—Ä–æ–º–æ</span>
        </div>
        <div class="nav-item" data-view="settings">
          <span class="nav-dot"></span>
          <span>–ù–∞—Å—Ç—Ä–æ–π–∫–∏ –º–∞–≥–∞–∑–∏–Ω–∞</span>
        </div>
      </nav>

      <div class="sidebar__footer">
        <div class="sidebar__footer-row">
          <span>ID –º–∞–≥–∞–∑–∏–Ω–∞</span>
          <span id="sidebarShopId">#shop_00127</span>
        </div>
        <div class="sidebar__footer-row">
          <span>–¢–∞—Ä–∏—Ñ</span>
          <span id="sidebarPlan">Pro ¬∑ –µ–∂–µ–º–µ—Å—è—á–Ω–æ</span>
        </div>
        <div class="sidebar__badge">
          <span class="sidebar__badge-dot"></span>
          <span id="sidebarUpdateInfo">–î–∞–Ω–Ω—ã–µ –æ–±–Ω–æ–≤–ª—è—é—Ç—Å—è –∫–∞–∂–¥—ã–µ 5 –º–∏–Ω—É—Ç</span>
        </div>
      </div>
    </aside>

    <!-- MAIN CONTENT -->
    <main class="main">
      <!-- HEADER -->
      <header class="header">
        <div class="header__titles">
          <div class="header__title">–î–∞—à–±–æ—Ä–¥ –º–∏–Ω–∏-–∞–ø–ø–∞</div>
          <div class="header__subtitle">
            –í–∏–¥–Ω–æ, –∫–∞–∫ –º–∏–Ω–∏-–∞–ø–ø —É–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç –≤—ã—Ä—É—á–∫—É, —Å—Ä–µ–¥–Ω–∏–π —á–µ–∫ –∏ –ø–æ–≤—Ç–æ—Ä–Ω—ã–µ –ø–æ–∫—É–ø–∫–∏.
          </div>
        </div>
        <div class="header__controls">
          <div class="period-switch">
            <button class="period-switch__btn period-switch__btn--active" data-period="30d">30 –¥–Ω–µ–π</button>
            <button class="period-switch__btn" data-period="7d">7 –¥–Ω–µ–π</button>
            <button class="period-switch__btn" data-period="today">–°–µ–≥–æ–¥–Ω—è</button>
          </div>
          <div class="header__profile">
            <div class="header__avatar" id="headerAvatar">IP</div>
            <div>
              <div id="headerOwnerName">–ò–≤–∞–Ω –ü–µ—Ç—Ä–æ–≤</div>
              <div style="font-size:10px; color:var(--text-muted);" id="headerOwnerRole">
                –í–ª–∞–¥–µ–ª–µ—Ü –º–∞–≥–∞–∑–∏–Ω–∞
              </div>
            </div>
            <button class="btn btn--ghost btn--xs" id="logoutBtn">–í—ã–π—Ç–∏</button>
          </div>
        </div>
      </header>

      <!-- VIEW: DASHBOARD -->
      <div class="view view--active" data-view="dashboard">
        <!-- KPI CARDS -->
        <section class="kpi-grid" id="dashboardKpis">
          <!-- KPI 1 -->
          <article class="card">
            <div class="card__inner">
              <div class="card__label">–í—ã—Ä—É—á–∫–∞ –æ—Ç –∫–ª–∏–µ–Ω—Ç–æ–≤ –º–∏–Ω–∏-–∞–ø–ø–∞</div>
              <div class="card__value">
                <span id="kpiRevenueValue">0&nbsp;‚ÇΩ</span>
                <span class="card__value-sub">–∑–∞ –≤—ã–±—Ä–∞–Ω–Ω—ã–π –ø–µ—Ä–∏–æ–¥</span>
              </div>
              <div class="card__hint">
                <span id="kpiRevenueShare">0%</span> –æ–±—â–µ–π –≤—ã—Ä—É—á–∫–∏ –º–∞–≥–∞–∑–∏–Ω–∞
              </div>
              <div class="card__delta" id="kpiRevenueDelta">
                ‚ñ≤ 0% –∫ –ø—Ä–µ–¥—ã–¥—É—â–µ–º—É –ø–µ—Ä–∏–æ–¥—É
              </div>
            </div>
          </article>

          <!-- KPI 2 -->
          <article class="card">
            <div class="card__inner">
              <div class="card__label">–ß–µ–∫–∏ –æ—Ç –∫–ª–∏–µ–Ω—Ç–æ–≤ –º–∏–Ω–∏-–∞–ø–ø–∞</div>
              <div class="card__value">
                <span id="kpiChecksValue">0</span>
                <span class="card__value-sub">—á–µ–∫–æ–≤</span>
              </div>
              <div class="card__hint">
                <span id="kpiChecksShare">0%</span> –≤—Å–µ—Ö —á–µ–∫–æ–≤ –º–∞–≥–∞–∑–∏–Ω–∞
              </div>
              <div class="card__separator"></div>
              <div class="card__pair-row">
                <span id="kpiChecksDeltaCount">+0 —á–µ–∫–æ–≤</span>
                <span id="kpiChecksDeltaText">–ø–æ —Å—Ä–∞–≤–Ω–µ–Ω–∏—é —Å –ø—Ä–æ—à–ª—ã–º –ø–µ—Ä–∏–æ–¥–æ–º</span>
              </div>
            </div>
          </article>

          <!-- KPI 3 -->
          <article class="card">
            <div class="card__inner">
              <div class="card__label">–°—Ä–µ–¥–Ω–∏–π —á–µ–∫</div>
              <div class="card__value">
                <span id="kpiAvgCheckMini">0&nbsp;‚ÇΩ</span>
                <span class="card__value-sub">mini-app</span>
              </div>
              <div class="card__pair-row" style="margin-bottom:6px;">
                <span class="card__hint">–û—Å—Ç–∞–ª—å–Ω—ã–µ –∫–ª–∏–µ–Ω—Ç—ã</span>
                <span class="card__hint" id="kpiAvgCheckAll">0&nbsp;‚ÇΩ</span>
              </div>
              <div class="card__delta" id="kpiAvgCheckDelta">
                ‚ñ≤ 0% –≤—ã—à–µ –æ–±—ã—á–Ω–æ–≥–æ
              </div>
            </div>
          </article>

          <!-- KPI 4 -->
          <article class="card">
            <div class="card__inner">
              <div class="card__label">–ü–æ–≤—Ç–æ—Ä–Ω—ã–µ –ø–æ–∫—É–ø–∫–∏</div>
              <div class="card__value">
                <span id="kpiRepeatShare">0%</span>
                <span class="card__value-sub">–∫–ª–∏–µ–Ω—Ç–æ–≤ mini-app</span>
              </div>
              <div class="card__hint">
                –°–æ–≤–µ—Ä—à–∏–ª–∏ 2+ –ø–æ–∫—É–ø–∫–∏ –∑–∞ –ø–µ—Ä–∏–æ–¥
              </div>
              <div class="card__separator"></div>
              <div class="card__pair-row">
                <span>–û—Å—Ç–∞–ª—å–Ω—ã–µ –∫–ª–∏–µ–Ω—Ç—ã</span>
                <span id="kpiRepeatOthers">0%</span>
              </div>
            </div>
          </article>
        </section>

        <!-- MAIN GRID: SALES + ACTIVITY -->
        <section class="grid-main">
          <!-- SALES PANEL -->
          <section class="panel">
            <div class="panel__inner">
              <div class="panel__header">
                <div>
                  <div class="panel__title">–î–∏–Ω–∞–º–∏–∫–∞ –≤—ã—Ä—É—á–∫–∏ mini-app</div>
                  <div class="panel__subtitle">
                    –°—Ä–∞–≤–Ω–µ–Ω–∏–µ –≤—ã—Ä—É—á–∫–∏ –æ—Ç –∫–ª–∏–µ–Ω—Ç–æ–≤ mini-app –∏ –æ—Å—Ç–∞–ª—å–Ω—ã—Ö –∫–ª–∏–µ–Ω—Ç–æ–≤.
                  </div>
                </div>
                <div class="panel__tags">
                  <span class="chip chip--active">–í—ã—Ä—É—á–∫–∞</span>
                  <span class="chip">–ß–µ–∫–∏</span>
                  <span class="chip">–°—Ä–µ–¥–Ω–∏–π —á–µ–∫</span>
                </div>
              </div>
              <div class="chart-placeholder" id="chartRevenue">
                –ó–¥–µ—Å—å –±—É–¥–µ—Ç –≥—Ä–∞—Ñ–∏–∫ (–¥–∞—Ç–∞ ‚Üí –≤—ã—Ä—É—á–∫–∞ mini-app / –≤—ã—Ä—É—á–∫–∞ –≤—Å–µ—Ö –∫–ª–∏–µ–Ω—Ç–æ–≤)
              </div>
              <div class="panel__footer-row">
                <span>–í—ã—Ä—É—á–∫–∞ mini-app: <b id="summaryRevenueMini">0&nbsp;‚ÇΩ</b></span>
                <span>–í—ã—Ä—É—á–∫–∞ –≤—Å–µ—Ö –∫–ª–∏–µ–Ω—Ç–æ–≤: <b id="summaryRevenueAll">0&nbsp;‚ÇΩ</b></span>
                <span>–î–æ–ª—è mini-app: <b id="summaryRevenueShare">0%</b></span>
              </div>
            </div>
          </section>

          <!-- ACTIVITY FEED PANEL -->
          <section class="panel">
            <div class="panel__inner">
              <div class="panel__header">
                <div>
                  <div class="panel__title">–ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç —Å–µ–π—á–∞—Å</div>
                  <div class="panel__subtitle">
                    –ñ–∏–≤–∞—è –ª–µ–Ω—Ç–∞ –¥–µ–π—Å—Ç–≤–∏–π –∫–ª–∏–µ–Ω—Ç–æ–≤ –º–∏–Ω–∏-–∞–ø–ø–∞.
                  </div>
                </div>
                <span class="pill">
                  <span class="pill__dot"></span>
                  —Ä–µ–∞–ª—å–Ω–æ–µ –≤—Ä–µ–º—è
                </span>
              </div>
              <ul class="feed-list" id="activityFeed">
                <!-- DEMO / PLACEHOLDER -->
                <li class="feed-item">
                  <div class="feed-item__time">–°–µ–≥–æ–¥–Ω—è ¬∑ 18:32</div>
                  <div class="feed-item__text">
                    –ö–ª–∏–µ–Ω—Ç <span class="feed-item__accent">@beerlover</span> –≤—ã–∏–≥—Ä–∞–ª –ø—Ä–∏–∑
                    ¬´–§–∏—Å—Ç–∞—à–∫–∏¬ª –∏ –∑–∞–±—Ä–∞–ª –µ–≥–æ –≤ –º–∞–≥–∞–∑–∏–Ω–µ.
                  </div>
                </li>
              </ul>
            </div>
          </section>
        </section>

        <!-- CLIENTS + LOYALTY -->
        <section class="two-col">
          <!-- CLIENTS -->
          <section class="panel">
            <div class="panel__inner">
              <div class="panel__header">
                <div>
                  <div class="panel__title">–ö–ª–∏–µ–Ω—Ç—ã –º–∏–Ω–∏-–∞–ø–ø–∞</div>
                  <div class="panel__subtitle">
                    –°–∫–æ–ª—å–∫–æ –Ω–æ–≤—ã—Ö –∏ –∞–∫—Ç–∏–≤–Ω—ã—Ö –∫–ª–∏–µ–Ω—Ç–æ–≤ –ø—Ä–∏—Ö–æ–¥–∏—Ç —á–µ—Ä–µ–∑ mini-app.
                  </div>
                </div>
              </div>
              <div class="stat-list">
                <div class="stat-list__row">
                  <span class="stat-list__label">–ù–æ–≤—ã—Ö –∑–∞ –ø–µ—Ä–∏–æ–¥</span>
                  <span class="stat-list__value" id="clientsNew">0 –∫–ª–∏–µ–Ω—Ç–æ–≤</span>
                </div>
                <div class="stat-list__row">
                  <span class="stat-list__label">–ê–∫—Ç–∏–≤–Ω—ã—Ö –∑–∞ –ø–µ—Ä–∏–æ–¥</span>
                  <span class="stat-list__value" id="clientsActive">0 –∫–ª–∏–µ–Ω—Ç–æ–≤</span>
                </div>
                <div class="stat-list__row">
                  <span class="stat-list__label">–í—Å–µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π mini-app</span>
                  <span class="stat-list__value" id="clientsTotal">0</span>
                </div>
              </div>
              <div class="chart-placeholder" style="margin-top:8px;" id="chartNewClients">
                –ú–∏–Ω–∏-–≥—Ä–∞—Ñ–∏–∫: –Ω–æ–≤—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ mini-app –ø–æ –¥–Ω—è–º
              </div>
            </div>
          </section>

          <!-- LOYALTY -->
          <section class="panel">
            <div class="panel__inner">
              <div class="panel__header">
                <div>
                  <div class="panel__title">–õ–æ—è–ª—å–Ω–æ—Å—Ç—å –∏ –≤–æ–∑–≤—Ä–∞—Ç—ã</div>
                  <div class="panel__subtitle">
                    –ö–∞–∫ —á–∞—Å—Ç–æ –∫–ª–∏–µ–Ω—Ç—ã mini-app –≤–æ–∑–≤—Ä–∞—â–∞—é—Ç—Å—è –∑–∞ –ø–æ–≤—Ç–æ—Ä–Ω–æ–π –ø–æ–∫—É–ø–∫–æ–π.
                  </div>
                </div>
              </div>
              <div class="stat-list">
                <div class="stat-list__row">
                  <span class="stat-list__label">–°–¥–µ–ª–∞–ª–∏ 2+ –ø–æ–∫—É–ø–∫–∏</span>
                  <span class="stat-list__value" id="retention2plus">
                    0%
                    <span class="stat-list__badge" id="retention2plusComment"></span>
                  </span>
                </div>
                <div class="stat-list__row">
                  <span class="stat-list__label">–°–¥–µ–ª–∞–ª–∏ 3+ –ø–æ–∫—É–ø–∫–∏</span>
                  <span class="stat-list__value" id="retention3plus">0%</span>
                </div>
                <div class="stat-list__row">
                  <span class="stat-list__label">–°—Ä–µ–¥–Ω–∏–π —Å—Ä–æ–∫ –¥–æ –ø–æ–≤—Ç–æ—Ä–Ω–æ–π –ø–æ–∫—É–ø–∫–∏</span>
                  <span class="stat-list__value" id="retentionAvgDays">‚Äì</span>
                </div>
              </div>
              <div class="chart-placeholder" style="margin-top:8px;" id="chartRetention">
                –ú–∏–Ω–∏-–≥—Ä–∞—Ñ–∏–∫: –∫–æ–Ω–≤–µ—Ä—Å–∏—è –≤ –ø–æ–≤—Ç–æ—Ä–Ω—É—é –ø–æ–∫—É–ø–∫—É –ø–æ –Ω–µ–¥–µ–ª—è–º
              </div>
            </div>
          </section>
        </section>

        <!-- GAMIFICATION + PROMO -->
        <section class="two-col">
          <!-- GAMIFICATION -->
          <section class="panel">
            <div class="panel__inner">
              <div class="panel__header">
                <div>
                  <div class="panel__title">–ì–µ–π–º–∏—Ñ–∏–∫–∞—Ü–∏—è: –∫–æ–ª–µ—Å–æ –∏ —à—Ç–∞–º–ø—ã</div>
                  <div class="panel__subtitle">
                    –ö–∞–∫ –º–∏–Ω–∏-–∏–≥—Ä—ã –∏ –ø–∞—Å–ø–æ—Ä—Ç —Å—Ç–∏–ª–µ–π –≤–ª–∏—è—é—Ç –Ω–∞ –≤—ã—Ä—É—á–∫—É.
                  </div>
                </div>
                <span class="pill">
                  üéÆ –≤–æ–≤–ª–µ—á—ë–Ω–Ω–æ—Å—Ç—å
                </span>
              </div>
              <div class="stat-list">
                <div class="stat-list__row">
                  <span class="stat-list__label">–í—Ä–∞—â–µ–Ω–∏–π –∫–æ–ª–µ—Å–∞ –∑–∞ –ø–µ—Ä–∏–æ–¥</span>
                  <span class="stat-list__value" id="gameSpins">0</span>
                </div>
                <div class="stat-list__row">
                  <span class="stat-list__label">–£–Ω–∏–∫–∞–ª—å–Ω—ã—Ö –∏–≥—Ä–æ–∫–æ–≤</span>
                  <span class="stat-list__value" id="gamePlayers">0</span>
                </div>
                <div class="stat-list__row">
                  <span class="stat-list__label">–°—Ä–µ–¥–Ω–∏–π —á–µ–∫ –∏–≥—Ä–æ–∫–æ–≤</span>
                  <span class="stat-list__value" id="gameAvgCheckPlayers">0&nbsp;‚ÇΩ</span>
                </div>
                <div class="stat-list__row">
                  <span class="stat-list__label">–°—Ä–µ–¥–Ω–∏–π —á–µ–∫ –±–µ–∑ –∏–≥—Ä</span>
                  <span class="stat-list__value" id="gameAvgCheckOthers">0&nbsp;‚ÇΩ</span>
                </div>
              </div>
              <div class="panel__footer-row" style="margin-top:8px;">
                <span id="gameFooterText">–ò–≥—Ä–æ–∫–∏ –æ—Å—Ç–∞–≤–ª—è—é—Ç –≤ —Å—Ä–µ–¥–Ω–µ–º –Ω–∞ 0 ‚ÇΩ –±–æ–ª—å—à–µ.</span>
              </div>
            </div>
          </section>

          <!-- PROMO TABLE (SUMMARY) -->
          <section class="panel">
            <div class="panel__inner">
              <div class="panel__header">
                <div>
                  <div class="panel__title">–ê–∫—Ü–∏–∏ –∏ –ø—Ä–æ–º–æ —á–µ—Ä–µ–∑ mini-app</div>
                  <div class="panel__subtitle">
                    –ö–∞–∫–∏–µ –∫–∞–º–ø–∞–Ω–∏–∏ –ø—Ä–∏–Ω–æ—Å—è—Ç –±–æ–ª—å—à–µ –≤—ã—Ä—É—á–∫–∏.
                  </div>
                </div>
              </div>
              <div style="overflow-x:auto;">
                <table class="table" id="promoTable">
                  <thead>
                    <tr>
                      <th>–ê–∫—Ü–∏—è</th>
                      <th>–ü–µ—Ä–∏–æ–¥</th>
                      <th>–ß–µ–∫–∏</th>
                      <th>–í—ã—Ä—É—á–∫–∞</th>
                      <th>–°—Ä–µ–¥–Ω–∏–π —á–µ–∫</th>
                      <th>–°—Ç–∞—Ç—É—Å</th>
                    </tr>
                  </thead>
                  <tbody>
                    <!-- demo rows, –±—É–¥—É—Ç –∑–∞–º–µ–Ω–µ–Ω—ã –¥–∞–Ω–Ω—ã–º–∏ -->
                  </tbody>
                </table>
              </div>
              <div class="panel__footer-row" style="margin-top:6px;">
                <span>–ß–µ—Ä–µ–∑ –ø—Ä–æ–º–æ-–∞–∫—Ü–∏–∏ mini-app: <b id="promoChecksTotal">0 —á–µ–∫–æ–≤</b></span>
                <span>–í—ã—Ä—É—á–∫–∞ –ø–æ –ø—Ä–æ–º–æ: <b id="promoRevenueTotal">0&nbsp;‚ÇΩ</b></span>
              </div>
            </div>
          </section>
        </section>
      </div>

      <!-- VIEW: SALES -->
      <div class="view" data-view="sales">
        <section class="panel">
          <div class="panel__inner">
            <div class="panel__header">
              <div>
                <div class="panel__title">–ü—Ä–æ–¥–∞–∂–∏ –≤ —Ä–∞–∑—Ä–µ–∑–µ –∫–∞–Ω–∞–ª–æ–≤</div>
                <div class="panel__subtitle">
                  –ü–æ–¥—Ä–æ–±–Ω–∞—è –∞–Ω–∞–ª–∏—Ç–∏–∫–∞ –≤—ã—Ä—É—á–∫–∏, —á–µ–∫–æ–≤ –∏ —Å—Ä–µ–¥–Ω–µ–≥–æ —á–µ–∫–∞ –ø–æ mini-app –∏ –¥—Ä—É–≥–∏–º –∫–∞–Ω–∞–ª–∞–º.
                </div>
              </div>
            </div>
            <div class="chart-placeholder" id="salesOverviewChart">
              –ó–¥–µ—Å—å –±—É–¥–µ—Ç –¥–µ—Ç–∞–ª—å–Ω—ã–π –≥—Ä–∞—Ñ–∏–∫/–¥–∏–∞–≥—Ä–∞–º–º—ã –ø–æ –ø—Ä–æ–¥–∞–∂–∞–º (–ø–æ –¥–Ω—è–º, –ø–æ –∫–∞–Ω–∞–ª–∞–º, –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º).
            </div>
          </div>
        </section>
        <section class="panel">
          <div class="panel__inner">
            <div class="panel__header">
              <div>
                <div class="panel__title">–¢–æ–ø-—Ç–æ–≤–∞—Ä—ã –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π mini-app</div>
                <div class="panel__subtitle">
                  –ö–∞–∫–∏–µ –ø–æ–∑–∏—Ü–∏–∏ —á–∞—â–µ –≤—Å–µ–≥–æ –ø–æ–∫—É–ø–∞—é—Ç –∫–ª–∏–µ–Ω—Ç—ã, –ø—Ä–∏—à–µ–¥—à–∏–µ —á–µ—Ä–µ–∑ mini-app.
                </div>
              </div>
            </div>
            <div class="chart-placeholder" id="salesTopProducts">
              –¢–∞–±–ª–∏—Ü–∞ / –≥—Ä–∞—Ñ–∏–∫: —Ç–æ–ø –ø–æ–∑–∏—Ü–∏–π –ø–æ –≤—ã—Ä—É—á–∫–µ –∏ –∫–æ–ª–∏—á–µ—Å—Ç–≤—É —á–µ–∫–æ–≤ —Å—Ä–µ–¥–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π mini-app.
            </div>
          </div>
        </section>
      </div>

      <!-- VIEW: CLIENTS -->
      <div class="view" data-view="clients">
        <section class="panel">
          <div class="panel__inner">
            <div class="panel__header">
              <div>
                <div class="panel__title">–ü–æ—Ä—Ç—Ä–µ—Ç –∫–ª–∏–µ–Ω—Ç–æ–≤ mini-app</div>
                <div class="panel__subtitle">
                  –ù–æ–≤—ã–µ, –∞–∫—Ç–∏–≤–Ω—ã–µ, –≤–æ–∑–≤—Ä–∞—â–∞—é—â–∏–µ—Å—è –∫–ª–∏–µ–Ω—Ç—ã, —Å–µ–≥–º–µ–Ω—Ç—ã, –∏—Å—Ç–æ—á–Ω–∏–∫–∏ –≤—Ö–æ–¥–∞.
                </div>
              </div>
            </div>
            <div class="chart-placeholder" id="clientsSegments">
              –ó–¥–µ—Å—å –±—É–¥–µ—Ç —Å–µ–≥–º–µ–Ω—Ç–∞—Ü–∏—è –∫–ª–∏–µ–Ω—Ç–æ–≤: –Ω–æ–≤—ã–µ / –ø–æ—Å—Ç–æ—è–Ω–Ω—ã–µ / —É—Å–Ω—É–≤—à–∏–µ, –∏—Å—Ç–æ—á–Ω–∏–∫–∏ (QR, –¥–æ—Å—Ç–∞–≤–∫–∞, —Å–æ—Ü—Å–µ—Ç–∏).
            </div>
          </div>
        </section>
        <section class="panel">
          <div class="panel__inner">
            <div class="panel__header">
              <div>
                <div class="panel__title">Retention –∏ –ø–æ–≤—Ç–æ—Ä–Ω—ã–µ –ø–æ–∫—É–ø–∫–∏</div>
                <div class="panel__subtitle">
                  –ö–∞–∫ –±—ã—Å—Ç—Ä–æ –∏ –∫–∞–∫ —á–∞—Å—Ç–æ –∫–ª–∏–µ–Ω—Ç—ã –≤–æ–∑–≤—Ä–∞—â–∞—é—Ç—Å—è –ø–æ—Å–ª–µ –ø–µ—Ä–≤–æ–π –ø–æ–∫—É–ø–∫–∏.
                </div>
              </div>
            </div>
            <div class="chart-placeholder" id="clientsRetentionDetail">
              –ì—Ä–∞—Ñ–∏–∫ —É–¥–µ—Ä–∂–∞–Ω–∏—è (D1, D7, D30) –∏ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∫–ª–∏–µ–Ω—Ç–æ–≤ —Å 2+ / 3+ –ø–æ–∫—É–ø–∫–∞–º–∏.
            </div>
          </div>
        </section>

        <!-- –ü–û–ò–°–ö –ö–û–ù–ö–†–ï–¢–ù–û–ì–û –ö–õ–ò–ï–ù–¢–ê -->
        <section class="panel">
          <div class="panel__inner">
            <div class="panel__header">
              <div>
                <div class="panel__title">–ö–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π –∫–ª–∏–µ–Ω—Ç mini-app</div>
                <div class="panel__subtitle">
                  –ë—ã—Å—Ç—Ä—ã–π –ø—Ä–æ—Å–º–æ—Ç—Ä —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –ø–æ –æ–¥–Ω–æ–º—É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é: —á–µ–∫–∏, –∏–≥—Ä—ã, —à—Ç–∞–º–ø—ã.
                </div>
              </div>
            </div>

            <div class="client-search-row">
              <input
                type="text"
                class="input"
                id="clientSearchInput"
                placeholder="@username, ID –∏–ª–∏ —Ç–µ–ª–µ—Ñ–æ–Ω"
              />
              <button class="btn" id="clientSearchBtn">–ü–æ–∫–∞–∑–∞—Ç—å</button>
            </div>

            <div class="client-card" id="clientCard" data-empty="true">
              <div class="client-card__header">
                <div>
                  <div class="client-card__name" id="clientCardName">–ò–º—è –∫–ª–∏–µ–Ω—Ç–∞</div>
                  <div class="client-card__id" id="clientCardId">@username ¬∑ ID</div>
                </div>
                <div class="client-card__badge" id="clientCardStatus">–∞–∫—Ç–∏–≤–µ–Ω</div>
              </div>

              <div class="client-card__grid">
                <div class="client-card__item">
                  <div class="client-card__label">–í—Å–µ–≥–æ —á–µ–∫–æ–≤</div>
                  <div class="client-card__value" id="clientCardChecks">0</div>
                </div>
                <div class="client-card__item">
                  <div class="client-card__label">–°—É–º–º–∞—Ä–Ω–∞—è –≤—ã—Ä—É—á–∫–∞</div>
                  <div class="client-card__value" id="clientCardRevenue">0&nbsp;‚ÇΩ</div>
                </div>
                <div class="client-card__item">
                  <div class="client-card__label">–ü–æ—Å–ª–µ–¥–Ω–∏–π –≤–∏–∑–∏—Ç</div>
                  <div class="client-card__value" id="clientCardLastVisit">‚Äì</div>
                </div>
                <div class="client-card__item">
                  <div class="client-card__label">–ò–≥—Ä—ã / –∫–æ–ª–µ—Å–æ</div>
                  <div class="client-card__value" id="clientCardGames">0 –≤—Ä–∞—â–µ–Ω–∏–π</div>
                </div>
                <div class="client-card__item">
                  <div class="client-card__label">–°–æ–±—Ä–∞–Ω–æ —à—Ç–∞–º–ø–æ–≤</div>
                  <div class="client-card__value" id="clientCardStamps">0 / 0</div>
                </div>
                <div class="client-card__item">
                  <div class="client-card__label">–ú–æ–Ω–µ—Ç—ã –Ω–∞ –±–∞–ª–∞–Ω—Å–µ</div>
                  <div class="client-card__value" id="clientCardCoins">0</div>
                </div>
              </div>
            </div>
          </div>
        </section>
      </div>

      <!-- VIEW: GAMIFICATION -->
      <div class="view" data-view="gamification">
        <section class="panel">
          <div class="panel__inner">
            <div class="panel__header">
              <div>
                <div class="panel__title">–ö–æ–ª–µ—Å–æ, —à—Ç–∞–º–ø—ã –∏ –º–∏–Ω–∏-–∏–≥—Ä—ã</div>
                <div class="panel__subtitle">
                  –ö–∞–∫ –≥–µ–π–º–∏—Ñ–∏–∫–∞—Ü–∏—è –≤–ª–∏—è–µ—Ç –Ω–∞ –≤—ã—Ä—É—á–∫—É, —Å—Ä–µ–¥–Ω–∏–π —á–µ–∫ –∏ —á–∞—Å—Ç–æ—Ç—É –ø–æ–∫—É–ø–æ–∫.
                </div>
              </div>
            </div>
            <div class="chart-placeholder" id="gamificationOverview">
              –ó–¥–µ—Å—å –±—É–¥–µ—Ç —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ —É—á–∞—Å—Ç–∏—è–º –≤ –∏–≥—Ä–∞—Ö, –≤—ã–¥–∞–Ω–Ω—ã–º —à—Ç–∞–º–ø–∞–º, –≤–ª–∏—è–Ω–∏—é –Ω–∞ —Å—Ä–µ–¥–Ω–∏–π —á–µ–∫.
            </div>
          </div>
        </section>
        <section class="panel">
          <div class="panel__inner">
            <div class="panel__header">
              <div>
                <div class="panel__title">–ü–∞—Å–ø–æ—Ä—Ç —Å—Ç–∏–ª–µ–π</div>
                <div class="panel__subtitle">
                  –°–∫–æ–ª—å–∫–æ –∫–ª–∏–µ–Ω—Ç–æ–≤ –Ω–∞—á–∞–ª–∏ —Å–æ–±–∏—Ä–∞—Ç—å –ø–∞—Å–ø–æ—Ä—Ç, —Å–∫–æ–ª—å–∫–æ –∑–∞–≤–µ—Ä—à–∏–ª–∏, –∫–∞–∫ —ç—Ç–æ –≤–ª–∏—è–µ—Ç –Ω–∞ –õ–¢–í.
                </div>
              </div>
            </div>
            <div class="chart-placeholder" id="gamificationStyles">
              –î–∏–∞–≥—Ä–∞–º–º–∞: % –∫–ª–∏–µ–Ω—Ç–æ–≤ —Å 1+ —à—Ç–∞–º–ø–æ–º, –ø–æ–ª–Ω–æ—Å—Ç—å—é —Å–æ–±—Ä–∞–≤—à–∏–µ –ø–∞—Å–ø–æ—Ä—Ç, –¥–∏–Ω–∞–º–∏–∫–∞ –ø–æ –Ω–µ–¥–µ–ª—è–º.
            </div>
          </div>
        </section>
      </div>

      <!-- VIEW: PROMOS -->
      <div class="view" data-view="promos">
        <section class="panel">
          <div class="panel__inner">
            <div class="panel__header">
              <div>
                <div class="panel__title">–≠—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –∞–∫—Ü–∏–π –∏ –ø—Ä–æ–º–æ</div>
                <div class="panel__subtitle">
                  –°—Ä–∞–≤–Ω–µ–Ω–∏–µ –∫–∞–º–ø–∞–Ω–∏–π –ø–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤—É —á–µ–∫–æ–≤, –≤—ã—Ä—É—á–∫–µ –∏ —Å—Ä–µ–¥–Ω–µ–º—É —á–µ–∫—É.
                </div>
              </div>
            </div>
            <div style="overflow-x:auto;">
              <table class="table" id="promoTableFull">
                <thead>
                  <tr>
                    <th>–ê–∫—Ü–∏—è</th>
                    <th>–ü–µ—Ä–∏–æ–¥</th>
                    <th>–ß–µ–∫–∏</th>
                    <th>–í—ã—Ä—É—á–∫–∞</th>
                    <th>–°—Ä–µ–¥–Ω–∏–π —á–µ–∫</th>
                    <th>–°—Ç–∞—Ç—É—Å</th>
                  </tr>
                </thead>
                <tbody>
                  <!-- –±—É–¥—É—Ç –ø–æ–¥—Å—Ç–∞–≤–ª–µ–Ω—ã —Ä–µ–∞–ª—å–Ω—ã–µ/–¥–µ–º–æ –¥–∞–Ω–Ω—ã–µ -->
                </tbody>
              </table>
            </div>
          </div>
        </section>
        <section class="panel">
          <div class="panel__inner">
            <div class="panel__header">
              <div>
                <div class="panel__title">–†–∞—Å—Å—ã–ª–∫–∏ –∏ –∫–∞–º–ø–∞–Ω–∏–∏</div>
                <div class="panel__subtitle">
                  –ö–æ–Ω–≤–µ—Ä—Å–∏–∏ –∏–∑ –ø—É—à–µ–π/—Ä–∞—Å—Å—ã–ª–æ–∫ mini-app –≤ —Ä–µ–∞–ª—å–Ω—ã–µ —á–µ–∫–∏ –∏ –≤—ã—Ä—É—á–∫—É.
                </div>
              </div>
            </div>
            <div class="chart-placeholder" id="promosCampaigns">
              –ó–¥–µ—Å—å –±—É–¥–µ—Ç –æ–±–∑–æ—Ä –ø–æ —Ä–∞—Å—Å—ã–ª–∫–∞–º: —Å–∫–æ–ª—å–∫–æ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ, –æ—Ç–∫—Ä—ã—Ç–∏–π, –ø–µ—Ä–µ—Ö–æ–¥–æ–≤, —á–µ–∫–æ–≤ –∏ –≤—ã—Ä—É—á–∫–∏.
            </div>
          </div>
        </section>
      </div>

      <!-- VIEW: SETTINGS -->
      <div class="view" data-view="settings">
        <section class="panel">
          <div class="panel__inner">
            <div class="panel__header">
              <div>
                <div class="panel__title">–ù–∞—Å—Ç—Ä–æ–π–∫–∏ –º–∞–≥–∞–∑–∏–Ω–∞</div>
                <div class="panel__subtitle">
                  –û—Å–Ω–æ–≤–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è, –≥–µ–π–º–∏—Ñ–∏–∫–∞—Ü–∏—è –∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –≤—ã–¥–∞—á–∏ –ø—Ä–∏–∑–æ–≤.
                </div>
              </div>
            </div>

            <div class="settings-grid">
              <!-- –ë–ª–æ–∫: –æ–±—â–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è -->
              <div class="settings-block">
                <div class="settings-block__title">–û–±—â–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è</div>
                <div class="settings-form-row">
                  <label class="settings-label">–ù–∞–∑–≤–∞–Ω–∏–µ –º–∞–≥–∞–∑–∏–Ω–∞</label>
                  <input class="input" type="text" id="settingShopName" />
                </div>
                <div class="settings-form-row">
                  <label class="settings-label">ID –º–∞–≥–∞–∑–∏–Ω–∞</label>
                  <input class="input" type="text" id="settingShopId" disabled />
                </div>
                <div class="settings-form-row">
                  <label class="settings-label">–ü–µ—Ä–∏–æ–¥ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö</label>
                  <select class="input" id="settingUpdatePeriod">
                    <option value="5m">–∫–∞–∂–¥—ã–µ 5 –º–∏–Ω—É—Ç</option>
                    <option value="15m">–∫–∞–∂–¥—ã–µ 15 –º–∏–Ω—É—Ç</option>
                    <option value="60m">–∫–∞–∂–¥—ã–π —á–∞—Å</option>
                  </select>
                </div>
              </div>

              <!-- –ë–ª–æ–∫: –∫–æ–ª–µ—Å–æ –∏ –ª–∏–º–∏—Ç—ã -->
              <div class="settings-block">
                <div class="settings-block__title">–ö–æ–ª–µ—Å–æ –∏ –ø—Ä–∏–∑—ã</div>
                <div class="settings-form-row">
                  <label class="settings-label">–ú–∞–∫—Å–∏–º—É–º –≤—Ä–∞—â–µ–Ω–∏–π –≤ –¥–µ–Ω—å –Ω–∞ –∫–ª–∏–µ–Ω—Ç–∞</label>
                  <input class="input" type="number" id="settingMaxSpinsPerDay" min="0" />
                </div>
                <div class="settings-form-row">
                  <label class="settings-label">–õ–∏–º–∏—Ç –ø—Ä–∏–∑–æ–≤ –≤ –¥–µ–Ω—å (–≤—Å–µ–≥–æ)</label>
                  <input class="input" type="number" id="settingMaxPrizesPerDay" min="0" />
                </div>
                <div class="settings-form-row">
                  <label class="settings-label">–£—á–∏—Ç—ã–≤–∞—Ç—å —Ç–æ–ª—å–∫–æ —á–µ–∫–∏ –æ—Ç 500 ‚ÇΩ</label>
                  <label class="switch">
                    <input type="checkbox" id="settingMinCheckEnabled" />
                    <span class="switch__slider"></span>
                  </label>
                </div>
                <div class="settings-form-row">
                  <label class="settings-label">–†–∞–∑—Ä–µ—à—ë–Ω–Ω—ã–µ –ø—Ä–∏–∑—ã</label>
                  <div class="settings-tags" id="settingPrizesList">
                    <!-- —á–µ–∫–±–æ–∫—Å—ã –ø—Ä–∏–∑–æ–≤ –±—É–¥—É—Ç –ø–æ–¥—Å—Ç–∞–≤–ª–µ–Ω—ã –∏–∑ API -->
                  </div>
                </div>
              </div>

              <!-- –ë–ª–æ–∫: –ü–ò–ù –∏ –¥–æ—Å—Ç—É–ø -->
              <div class="settings-block">
                <div class="settings-block__title">–ü–ò–ù –∏ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∏</div>
                <div class="settings-form-row">
                  <label class="settings-label">–ü–ò–ù –¥–ª—è –≤—ã–¥–∞—á–∏ –ø—Ä–∏–∑–æ–≤ –∏ —à—Ç–∞–º–ø–æ–≤</label>
                  <input class="input" type="password" id="settingPin" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢" />
                </div>
                <div class="settings-form-row">
                  <label class="settings-label">–°–ø–∏—Å–æ–∫ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤ —Å –¥–æ—Å—Ç—É–ø–æ–º</label>
                  <textarea
                    class="input"
                    rows="3"
                    id="settingStaff"
                    placeholder="@barmen1 ¬∑ –±–∞—Ä, @barmen2 ¬∑ –±–∞—Ä, @courier1 ¬∑ –¥–æ—Å—Ç–∞–≤–∫–∞"
                  ></textarea>
                </div>
                <div class="settings-form-row">
                  <label class="settings-label">–û–≥—Ä–∞–Ω–∏—á–∏—Ç—å –≤—ã–¥–∞—á—É –ø—Ä–∏–∑–æ–≤ –≤ —Å–º–µ–Ω—É</label>
                  <label class="switch">
                    <input type="checkbox" id="settingLimitPerShift" />
                    <span class="switch__slider"></span>
                  </label>
                </div>
              </div>
            </div>

            <div style="margin-top:12px; display:flex; justify-content:flex-end; gap:8px; flex-wrap:wrap;">
              <button class="btn btn--ghost" id="settingsResetBtn">–û—Ç–º–µ–Ω–∏—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è</button>
              <button class="btn" id="settingsSaveBtn">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å –Ω–∞—Å—Ç—Ä–æ–π–∫–∏</button>
            </div>
          </div>
        </section>
      </div>
    </main>
  </div>

  <script src="api.js"></script>
  <script>
    // --- init ---
    document.addEventListener("DOMContentLoaded", async function () {
      // –ü—Ä–æ–≤–µ—Ä—è–µ–º –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—é (–µ—Å–ª–∏ –Ω–µ DEMO_MODE)
      if (!API.DEMO_MODE && !API.isLoggedIn()) {
        window.location.href = "index.html";
        return;
      }

      const navItems = document.querySelectorAll(".nav-item[data-view]");
      const views = document.querySelectorAll(".view[data-view]");
      const headerTitle = document.querySelector(".header__title");
      const headerSubtitle = document.querySelector(".header__subtitle");

      const viewMeta = {
        dashboard: {
          title: "–î–∞—à–±–æ—Ä–¥ –º–∏–Ω–∏-–∞–ø–ø–∞",
          subtitle: "–í–∏–¥–Ω–æ, –∫–∞–∫ –º–∏–Ω–∏-–∞–ø–ø —É–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç –≤—ã—Ä—É—á–∫—É, —Å—Ä–µ–¥–Ω–∏–π —á–µ–∫ –∏ –ø–æ–≤—Ç–æ—Ä–Ω—ã–µ –ø–æ–∫—É–ø–∫–∏.",
        },
        sales: {
          title: "–ü—Ä–æ–¥–∞–∂–∏",
          subtitle: "–î–µ—Ç–∞–ª–∏–∑–∞—Ü–∏—è –≤—ã—Ä—É—á–∫–∏, —á–µ–∫–æ–≤ –∏ —Å—Ä–µ–¥–Ω–µ–≥–æ —á–µ–∫–∞ –ø–æ mini-app –∏ –¥—Ä—É–≥–∏–º –∫–∞–Ω–∞–ª–∞–º.",
        },
        clients: {
          title: "–ö–ª–∏–µ–Ω—Ç—ã",
          subtitle: "–ù–æ–≤—ã–µ, –∞–∫—Ç–∏–≤–Ω—ã–µ –∏ –≤–æ–∑–≤—Ä–∞—â–∞—é—â–∏–µ—Å—è –∫–ª–∏–µ–Ω—Ç—ã mini-app, –∏—Å—Ç–æ—á–Ω–∏–∫–∏ –∏ —Å–µ–≥–º–µ–Ω—Ç—ã.",
        },
        gamification: {
          title: "–ì–µ–π–º–∏—Ñ–∏–∫–∞—Ü–∏—è",
          subtitle: "–ê–Ω–∞–ª–∏—Ç–∏–∫–∞ –ø–æ –∫–æ–ª–µ—Å—É, —à—Ç–∞–º–ø–∞–º –∏ –º–∏–Ω–∏-–∏–≥—Ä–∞–º: –≤–ª–∏—è–Ω–∏–µ –Ω–∞ LTV –∏ —Å—Ä–µ–¥–Ω–∏–π —á–µ–∫.",
        },
        promos: {
          title: "–ê–∫—Ü–∏–∏ –∏ –ø—Ä–æ–º–æ",
          subtitle: "–≠—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –∞–∫—Ü–∏–π, –ø—Ä–æ–º–æ–∫–æ–¥–æ–≤ –∏ —Ä–∞—Å—Å—ã–ª–æ–∫ —á–µ—Ä–µ–∑ mini-app.",
        },
        settings: {
          title: "–ù–∞—Å—Ç—Ä–æ–π–∫–∏ –º–∞–≥–∞–∑–∏–Ω–∞",
          subtitle: "–ü–∞—Ä–∞–º–µ—Ç—Ä—ã –º–∞–≥–∞–∑–∏–Ω–∞, –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ –∏ –ø—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞.",
        },
      };

      navItems.forEach((item) => {
        item.addEventListener("click", () => {
          const targetView = item.dataset.view;
          navItems.forEach((i) => i.classList.toggle("nav-item--active", i === item));
          views.forEach((view) =>
            view.classList.toggle("view--active", view.dataset.view === targetView)
          );

          const meta = viewMeta[targetView];
          if (meta) {
            headerTitle.textContent = meta.title;
            headerSubtitle.textContent = meta.subtitle;
          }
        });
      });

      const periodButtons = document.querySelectorAll(".period-switch__btn");
      periodButtons.forEach((btn) => {
        btn.addEventListener("click", async () => {
          periodButtons.forEach((b) =>
            b.classList.remove("period-switch__btn--active")
          );
          btn.classList.add("period-switch__btn--active");

          const period = btn.dataset.period;
          await loadDashboard(period);
        });
      });

      // logout
      document.getElementById("logoutBtn").addEventListener("click", () => {
        API.logout();
        window.location.href = "index.html";
      });

      // –ü–æ–∏—Å–∫ –∫–ª–∏–µ–Ω—Ç–∞
      const clientInput = document.getElementById("clientSearchInput");
      const clientBtn = document.getElementById("clientSearchBtn");
      clientBtn.addEventListener("click", async () => {
        const q = (clientInput.value || "").trim();
        if (!q) return;
        const data = await API.getClientByQuery(q);
        renderClientCard(data);
      });

      // –ù–∞—Å—Ç—Ä–æ–π–∫–∏
      document.getElementById("settingsSaveBtn").addEventListener("click", async () => {
        const payload = collectSettingsFromUI();
        await API.updateSettings(payload);
        alert("–ù–∞—Å—Ç—Ä–æ–π–∫–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã (–¥–µ–º–æ).");
      });

      document.getElementById("settingsResetBtn").addEventListener("click", async () => {
        const settings = await API.getSettings();
        renderSettings(settings);
      });

      // –ó–∞–≥—Ä—É–∂–∞–µ–º –¥–∞–Ω–Ω—ã–µ
      const me = await API.getMe();
      renderOwner(me);

      const dashboardData = await API.getDashboard();
      renderDashboard(dashboardData);

      const settingsData = await API.getSettings();
      renderSettings(settingsData);
    });

    function renderOwner(me) {
      if (!me) return;
      const shop = me.shop || {};
      document.getElementById("sidebarShopName").textContent =
        shop.name || "–ú–∞–≥–∞–∑–∏–Ω";
      document.getElementById("sidebarShopId").textContent =
        "#" + (shop.id || "shop");
      document.getElementById("sidebarShopNote").textContent =
        shop.started_at || "";
      document.getElementById("sidebarPlan").textContent =
        shop.plan_label || "Pro";
      document.getElementById("sidebarUpdateInfo").textContent =
        shop.update_label || "–î–∞–Ω–Ω—ã–µ –æ–±–Ω–æ–≤–ª—è—é—Ç—Å—è –∫–∞–∂–¥—ã–µ 5 –º–∏–Ω—É—Ç";

      document.getElementById("headerOwnerName").textContent =
        me.owner_name || "–í–ª–∞–¥–µ–ª–µ—Ü";
      const initials =
        (me.owner_name || "–í –ü")
          .split(" ")
          .map((s) => s[0])
          .join("")
          .slice(0, 2)
          .toUpperCase();
      document.getElementById("headerAvatar").textContent = initials;
      document.getElementById("headerOwnerRole").textContent =
        me.owner_role || "–í–ª–∞–¥–µ–ª–µ—Ü –º–∞–≥–∞–∑–∏–Ω–∞";
    }

    function renderDashboard(d) {
      if (!d) return;

      document.getElementById("kpiRevenueValue").innerHTML =
        API.formatMoney(d.revenue_mini);
      document.getElementById("kpiRevenueShare").textContent =
        (d.revenue_share || 0) + "%";
      document.getElementById("kpiRevenueDelta").textContent =
        "‚ñ≤ " + (d.revenue_delta || 0) + "% –∫ –ø—Ä–µ–¥—ã–¥—É—â–µ–º—É –ø–µ—Ä–∏–æ–¥—É";

      document.getElementById("kpiChecksValue").textContent =
        d.checks_mini || 0;
      document.getElementById("kpiChecksShare").textContent =
        (d.checks_share || 0) + "%";
      document.getElementById("kpiChecksDeltaCount").textContent =
        (d.checks_delta_count > 0 ? "+" : "") +
        (d.checks_delta_count || 0) +
        " —á–µ–∫–æ–≤";
      document.getElementById("kpiChecksDeltaText").textContent =
        "–ø–æ —Å—Ä–∞–≤–Ω–µ–Ω–∏—é —Å –ø—Ä–æ—à–ª—ã–º –ø–µ—Ä–∏–æ–¥–æ–º";

      document.getElementById("kpiAvgCheckMini").innerHTML = API.formatMoney(
        d.avg_check_mini
      );
      document.getElementById("kpiAvgCheckAll").innerHTML = API.formatMoney(
        d.avg_check_all
      );
      document.getElementById("kpiAvgCheckDelta").textContent =
        "‚ñ≤ " + (d.avg_check_delta || 0) + "% –≤—ã—à–µ –æ–±—ã—á–Ω–æ–≥–æ";

      document.getElementById("kpiRepeatShare").textContent =
        (d.repeat_share || 0) + "%";
      document.getElementById("kpiRepeatOthers").textContent =
        (d.repeat_others || 0) + "%";

      document.getElementById("summaryRevenueMini").innerHTML =
        API.formatMoney(d.revenue_mini);
      document.getElementById("summaryRevenueAll").innerHTML =
        API.formatMoney(d.revenue_all);
      document.getElementById("summaryRevenueShare").textContent =
        (d.revenue_share || 0) + "%";

      document.getElementById("clientsNew").textContent =
        (d.clients_new || 0) + " –∫–ª–∏–µ–Ω—Ç–æ–≤";
      document.getElementById("clientsActive").textContent =
        (d.clients_active || 0) + " –∫–ª–∏–µ–Ω—Ç–æ–≤";
      document.getElementById("clientsTotal").textContent =
        d.clients_total || 0;

      document.getElementById("retention2plus").innerHTML =
        (d.retention_2plus || 0) +
        '% <span class="stat-list__badge" id="retention2plusComment">' +
        (d.retention_2plus_comment || "") +
        "</span>";
      document.getElementById("retention3plus").textContent =
        (d.retention_3plus || 0) + "%";
      document.getElementById("retentionAvgDays").textContent =
        d.retention_avg_days || "-";

      document.getElementById("gameSpins").textContent = d.games_spins || 0;
      document.getElementById("gamePlayers").textContent =
        d.games_players || 0;
      document.getElementById("gameAvgCheckPlayers").innerHTML =
        API.formatMoney(d.games_avg_check_players);
      document.getElementById("gameAvgCheckOthers").innerHTML =
        API.formatMoney(d.games_avg_check_others);
      document.getElementById("gameFooterText").textContent =
        "–ò–≥—Ä–æ–∫–∏ –æ—Å—Ç–∞–≤–ª—è—é—Ç –≤ —Å—Ä–µ–¥–Ω–µ–º –Ω–∞ " +
        API.formatMoney(d.games_extra_revenue_per_client) +
        " –±–æ–ª—å—à–µ.";

      const tbodySummary = document.querySelector("#promoTable tbody");
      const tbodyFull = document.querySelector("#promoTableFull tbody");
      tbodySummary.innerHTML = "";
      tbodyFull.innerHTML = "";
      let totalChecks = 0;
      let totalRevenue = 0;

      (d.promos || []).forEach((p) => {
        totalChecks += p.checks || 0;
        totalRevenue += p.revenue || 0;

        const row1 = document.createElement("tr");
        row1.innerHTML = createPromoRowHtml(p);
        tbodySummary.appendChild(row1);

        const row2 = document.createElement("tr");
        row2.innerHTML = createPromoRowHtml(p);
        tbodyFull.appendChild(row2);
      });

      document.getElementById("promoChecksTotal").textContent =
        totalChecks + " —á–µ–∫–æ–≤";
      document.getElementById("promoRevenueTotal").innerHTML =
        API.formatMoney(totalRevenue);
    }

    function createPromoRowHtml(p) {
      const statusClass =
        p.status === "finished" ? "badge-status badge-status--ended" : "badge-status";
      const statusLabel = p.status === "finished" ? "–∑–∞–≤–µ—Ä—à–µ–Ω–∞" : "–∞–∫—Ç–∏–≤–Ω–∞";
      return `
        <td>${p.name || ""}</td>
        <td>${p.period || ""}</td>
        <td>${p.checks || 0}</td>
        <td>${API.formatMoney(p.revenue || 0)}</td>
        <td>${API.formatMoney(p.avg_check || 0)}</td>
        <td>
          <span class="${statusClass}">
            <span class="badge-status__dot"></span>
            ${statusLabel}
          </span>
        </td>
      `;
    }

    function renderSettings(s) {
      if (!s) return;
      document.getElementById("settingShopName").value = s.shop_name || "";
      document.getElementById("settingShopId").value = s.shop_id || "";
      document.getElementById("settingUpdatePeriod").value =
        s.update_period || "5m";
      document.getElementById("settingMaxSpinsPerDay").value =
        s.max_spins_per_day ?? "";
      document.getElementById("settingMaxPrizesPerDay").value =
        s.max_prizes_per_day ?? "";
      document.getElementById("settingMinCheckEnabled").checked =
        !!s.min_check_enabled;
      document.getElementById("settingPin").value = s.pin_mask || "‚Ä¢‚Ä¢‚Ä¢‚Ä¢";
      document.getElementById("settingStaff").value = s.staff_list || "";
      document.getElementById("settingLimitPerShift").checked =
        !!s.limit_per_shift;

      const container = document.getElementById("settingPrizesList");
      container.innerHTML = "";
      (s.prizes || []).forEach((p) => {
        const label = document.createElement("label");
        label.className = "tag-checkbox";
        label.innerHTML = `
          <input type="checkbox" data-prize-code="${p.code}" ${
          p.enabled ? "checked" : ""
        } />
          <span>${p.name}</span>
        `;
        container.appendChild(label);
      });
    }

    function collectSettingsFromUI() {
      const prizes = [];
      document
        .querySelectorAll("#settingPrizesList input[type=checkbox]")
        .forEach((input) => {
          prizes.push({
            code: input.dataset.prizeCode,
            enabled: input.checked,
          });
        });

      return {
        shop_name: document.getElementById("settingShopName").value,
        shop_id: document.getElementById("settingShopId").value,
        update_period: document.getElementById("settingUpdatePeriod").value,
        max_spins_per_day: Number(
          document.getElementById("settingMaxSpinsPerDay").value || 0
        ),
        max_prizes_per_day: Number(
          document.getElementById("settingMaxPrizesPerDay").value || 0
        ),
        min_check_enabled: document.getElementById(
          "settingMinCheckEnabled"
        ).checked,
        pin_mask: document.getElementById("settingPin").value,
        staff_list: document.getElementById("settingStaff").value,
        limit_per_shift: document.getElementById("settingLimitPerShift").checked,
        prizes,
      };
    }

    function renderClientCard(c) {
      if (!c) return;
      document.getElementById("clientCardName").textContent =
        c.name || "–ö–ª–∏–µ–Ω—Ç";
      document.getElementById("clientCardId").textContent =
        (c.username ? "@" + c.username : "ID " + c.id) +
        (c.id ? " ¬∑ " + c.id : "");
      document.getElementById("clientCardStatus").textContent =
        c.status_label || "–∞–∫—Ç–∏–≤–µ–Ω";
      document.getElementById("clientCardChecks").textContent =
        c.checks_total || 0;
      document.getElementById("clientCardRevenue").innerHTML =
        API.formatMoney(c.revenue_total || 0);
      document.getElementById("clientCardLastVisit").textContent =
        c.last_visit || "-";
      document.getElementById("clientCardGames").textContent =
        (c.games_spins || 0) + " –≤—Ä–∞—â–µ–Ω–∏–π";
      document.getElementById("clientCardStamps").textContent =
        (c.stamps_collected || 0) + " / " + (c.stamps_total || 0);
      document.getElementById("clientCardCoins").textContent =
        c.coins_balance || 0;
      document.getElementById("clientCard").dataset.empty = "false";
    }

    async function loadDashboard(period) {
      const data = await API.getDashboard(period);
      renderDashboard(data);
    }
  </script>
</body>
</html>
